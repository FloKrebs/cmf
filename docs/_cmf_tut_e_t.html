<!-- HTML header for doxygen 1.8.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<title>cmf: $title</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen_extra.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
  <span id="projectlogo"><img alt="cmf - the catchment modelling framework" src="cmf-logo-klein.png"/></span>
  <span style="padding-left: 2em;">
   <span id="projectname">cmf
   &#160;<span id="projectnumber">1.3</span>
   </span>
   <span id="projectbrief">The Catchment Modelling Framework</span>
  </span>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">index</a></li><li class="navelem"><a class="el" href="tutorial.html">tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="contents">
<div class="textblock"><p><a class="el" href="_cmf_tut_intercept.html">next...</a></p>
<h1>Evapotranspiration (incomplete)</h1>
<p>Several models exist to calculate water losses from the soil and surfaces to the atmosphere.</p>
<p><b>Evaporation</b> is the vaporization from a surface with no transition through a biologically active membrane. Evaporation is thus governed only by the physical environment. <b>Transpiration</b> is vaporization from a biological surface, steered by active opening and closing. For our cases only the transpiration of plants is of interest. Many models for vaporization use the term "Evapotranspiration" which is the bulk sum of evaporation and transpiration, since soil evaporation and plant transpiration influence each other and are complex to differentiate. From the water storage perspective, the main difference is, that plants take up water from several soil layers (if the rooting zone is divided in serveral layers), but soil evaporation takes water from the first layer only (ok except for very, very dry regions), open water evaporation from <a class="el" href="classcmf_1_1river_1_1_open_water_storage.html">OpenWaterStorage</a> like surface water, rivers and lakes. Water that is intercepted by vegetation (see <a class="el" href="_cmf_tut_intercept.html">next</a> tutorial) either percolates to the surface water or evaporates from the leaf surface. Since transpiration is the main part of bulk evapotranspiration in vegetated soils, models that deal only with bulk evapotranspiration handle the bulk flux as we would have transpiration only. However, by including a canopy water storage, interception of rain on the plant leaves can be considered.</p>
<h1>Potential bulk evapotranspiration</h1>
<p>Evapotranspiration is subject to many processes depending on vast amount of environmental conditions. To get a structure, one can differ between an energy limit and a water limitation. The energy limitation is expressed by the term '''potential evapotranspiration''' \(ET_{pot}\) the water that would be vaporized if enough water is available. \(ET_{pot}\) is determined by the surface structure (land cover) and meteorological conditions. If the surface structure is assumed to be a reference surface, (short, mown grass with defined properties), we get the '''reference evapotranspiration''' \(ET_{ref}\), which is depending on meteorological conditions only. The '''actual evapotranspiration''' \(ET_{act}\) which is limited by water and energy, depends also the soil moisture in the rooting zone and is usually calculated from \(ET_{pot}\) using a limiting factor. While you can use cmf to calculate \(ET_{act}\) from vegetation cover, meteorological conditions and soil moisture directly, using different models, one can also precalculate an \(ET_{pot}\) timeseries and cmf calculates \(ET_{act}\) from these values. In order to test different models, you need to have the code from [wiki:CmfTut1d] at hand, since we will extend the 1D model by ET models.</p>
<h2>Getting {{{ \(ET_{act}\)}}} from {{{ \(ET_{pot}\)}}} with cmf</h2>
<p>In order to calculate the water loss to the atmosphere from a given or calculated \(ET_{pot} [\frac{mm}{day}]\) value, cmf needs to partition the water demand between the layers. Since bulk ET is handled as transpiration, the partitioning is done using the root content of a layer:</p>
<p class="formulaDsp">
\[ [q_{T_{pot}}\left[\tfrac{m^3}{day}\right]=f_r|ET_{pot}\left[\tfrac{mm}{day}\right]]A_{cell}[[m^2]|\tfrac{1 m}{1000 mm} \]
</p>
<p>]</p>
<p>where: - \(f_r=\frac{R_{layer}}{\sum_{i=0}^{layers}{R_i}}\) the root mass in this layer per total root mass at this cell. - \(A_{cell}\) is the area of the cell</p>
<p>To limit water uptake from the soil layer according to its water content, cmf uses a Feddes like approach: The flux is 0, when the matrix potential \(\Psi_M\) is below wilting point. If the matrix potential is below -5m, the limitation is linearly scaled towards the wilting point and above -5m there is no water limitation:</p>
<p class="formulaDsp">
\[ [q_{T_{act}}|= q_{T_{pot}}\begin{cases} 1 &amp; \Psi_M&gt;-5m \\ 1+\tfrac{\Psi_M + 5}{155} &amp; \Psi_M&gt;-160m \\ 0 &amp; \Psi_M&lt;-160 m\end{cases} \]
</p>
<p>]</p>
<h3>Setting the root content {{{ \(f_r\)}}}</h3>
<p>In principle, there are two ways to define the root content, set the root content fraction for each layer or define the root depth for the cell</p>
<h4>a) set the root content directly</h4>
<p>Soil layers have the property <code>rootfraction</code> that can be set. It is '''your''' responsibility to ensure that the sum of all rootfractions is 1.</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> l <span class="keywordflow">in</span> cell.layers[:5]:</div><div class="line">    l.rootfraction = 0.2</div></div><!-- fragment --><p>If you have never set the rootfraction method b) is used.</p>
<h4>b) set the root depth for the cell</h4>
<p>If the <code>rootfraction</code> of a layer has never been set, the root fraction of the layers are calculated from the <code>RootDepth</code> and <code>fraction_at_rootdepth</code> properties of the cell's vegetation object. <code>RootDepth</code> is the depth of the rooting zone of the cell in m. If <code>fraction_at_rootdepth</code> is 1, a uniform distribution of roots until <code>RootDepth</code> is used. If <code>fraction_at_rootdepth</code> is between 0..1, then an exponential decline of the root content is used. <code>1-fraction_at_rootdepth</code> of the root mass is then below <code>RootDepth</code>.</p>
<p>In this example we will get the same result as in a):</p>
<div class="fragment"><div class="line">cell.vegetation.RootDepth = 0.5</div></div><!-- fragment --><p>Here we will have 80% of the root content in the upper 40cm, and the other 20% below using an exponential decline of the root content:</p>
<div class="fragment"><div class="line">cell.vegetation.RootDepth = 0.4</div><div class="line">cell.vegetation.fraction_at_rootdepth = 0.8</div></div><!-- fragment --><p>If you do nothing, the <code>RootDepth</code> default value of 0.25 is used.</p>
<h2>Using precalculated {{{ \(ET_{pot}\)}}} timeseries</h2>
<div class="image">
<img src="CmfTut1d-ET1.png" alt="CmfTut1d-ET1.png"/>
</div>
<p>As a first step, you need to have your values stored in a <a class="el" href="_cmf_tut_space_time.html">timeseries</a>, for the following code named ET. The timeseries needs to have the unit of mm/day. To get \(ET_{act}\), you will connect every soil layer in the rooting zone with the <code>transpiration</code> boundary condition of the cell with the <a class="el" href="classcmf_1_1upslope_1_1_e_t_1_1timeseries_e_tpot.html">timeseriesETpot</a> connection.</p>
<p>The following code snippet is an extensions the setup code from <a class="el" href="_cmf_tut1d.html">1D model</a> without the groundwater boundary condition. Think about the position of the snippet in the code. For simplicity, we are using a constant ETpot value. And to avoid changing the run time duration and see nice effects anyway, the constant ETpot is set to the absurd high value of 20 mm/day. The initial condition <a class="el" href="_cmf_tut_retentioncurve.html">saturated depth</a> is also changed to 4m.</p>
<div class="fragment"><div class="line">cell.saturated_depth = 4.</div><div class="line">ETpot = cmf.timeseries.from_scalar(20.0) <span class="comment"># constant ETpot of 20 mm/day (I know that this is too much)</span></div><div class="line"></div><div class="line"><span class="comment"># Set root content</span></div><div class="line">cell.vegetation.RootDepth = .4</div><div class="line">cell.vegetation.fraction_at_rootdepth = 0.8</div><div class="line"><span class="keywordflow">for</span> layer <span class="keywordflow">in</span> cell.layers:</div><div class="line">    <span class="comment"># connect each layer with the transpiration boundary condition using ETpot</span></div><div class="line">    cmf.timeseriesETpot(layer, cell.transpiration, ETpot)</div></div><!-- fragment --><p>The potential plot is not so nice, hence let us rather look at the pF values in the layers. The pF value are calculated from the potential by <code>pF = log10(-100\*array(potential))</code>. With this change, the result is shown on the right side.</p>
<h2>Calculating {{{ \(ET_{pot}\)}}} from data</h2>
<p>Up to now, to different methods to calculate \(ET_{pot}\) are available in cmf <a class="el" href="classcmf_1_1upslope_1_1_e_t_1_1_hargreave_e_t.html">Hargreaves</a> and <a class="el" href="classcmf_1_1upslope_1_1_e_t_1_1_penman_monteith_e_t.html">PenmanMonteithET</a>.</p>
<h3>Penman-Monteith (FAO) (inclomplete)</h3>
<p>In order to calculate \(ET_{pot}\) from the actual <a class="el" href="structcmf_1_1atmosphere_1_1_weather.html">Weather</a> and <a class="el" href="classcmf_1_1upslope_1_1vegetation_1_1_vegetation.html">Vegetation</a> according to the FAO Penman-Monteith method (<a href="http://www.fao.org/docrep/x0490e/x0490e00.htm#Contents">Allen, 1998</a>), use <a class="el" href="classcmf_1_1upslope_1_1_e_t_1_1_penman_monteith_e_t.html">PenmanMonteithET</a>. It is installed by:</p>
<div class="fragment"><div class="line">cell.install_connection(cmf.PenmanMonteithET)</div></div><!-- fragment --><h3>Hargreaves</h3>
<p>Implements the ET method by Hargeaves in the variation by <a href="http://www.zohrabsamani.com/research_material/files/Hargreaves-samani.pdf">Samani (2000)</a>. This method calculates only \(ET_{ref}\) and thus ignores the cell's <a class="el" href="classcmf_1_1upslope_1_1vegetation_1_1_vegetation.html">Vegetation</a> object.</p>
<h1>Separating evaporation from transpiration</h1>
<p>The separation of plant transpiration and soil evaporation is quite complex, since a vegetation cover does intercept the incoming radiation and changes, by transpiration the vapor pressure deficit inside the canopy. The only method, that separates soil evaporation from plant transpiration implemented in cmf so far, is the <a class="el" href="classcmf_1_1upslope_1_1_e_t_1_1_shuttleworth_wallace.html">ShuttleworthWallace</a>. It implements the evaporation method given by <a href="http://tlaxiaco.sdsu.edu/shuttleworthwallace.pdf">Shuttleworth (1985)</a> as used in <a href="http://www.ecoshift.net/brook/brook90.htm">BROOK90 (Federer 1995)</a>. To install all necessary connections, use:</p>
<div class="fragment"><div class="line">cell.install_connection(cmf.ShuttleWorthWallace)</div></div><!-- fragment --><p>If you want to use canopy evaporation and snow sublimation, make sure you have created the appropriate storages from the <a class="el" href="_cmf_tut_intercept.html">next</a> tutorial before installation.</p>
<p><a class="el" href="classcmf_1_1upslope_1_1_e_t_1_1_shuttleworth_wallace.html">ShuttleworthWallace</a> is quite parameter demanding - all meteorological parameters available in the <a class="el" href="structcmf_1_1atmosphere_1_1_weather.html">Weather</a> object are used as well as all parameters of the <a class="el" href="classcmf_1_1upslope_1_1vegetation_1_1_vegetation.html">Vegetation</a> object .</p>
<dl class="section author"><dt>Author</dt><dd>philipp, version: 16 Thu Nov 9 15:40:49 2017 </dd></dl>
</div></div><!-- contents -->
<hr class="footer"/><address class="footer"><small>
<div>&copy 2008-2017 by 
<a class="el" href="http://www.uni-giessen.de/hydro/kraft"> Philipp Kraft</a> and
<a class="el" href="http://www.uni-giessen.de/hydro"> 
Institute of Landscape Ecology and Resources Management,University of Gie&szlig;en</a>
</h3></td>
<td>Generated: Wed Apr 11 2018 15:12:27</td>
</tr></table>
</small></address>
</body>
</html>
